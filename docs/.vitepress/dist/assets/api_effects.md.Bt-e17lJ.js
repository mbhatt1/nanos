import{_ as h,C as o,c,o as e,j as n,b as l,ah as r,a as i,w as a,G as p,ai as d}from"./chunks/framework.CpSv75ol.js";const F=JSON.parse('{"title":"Effects Reference","description":"","frontmatter":{},"headers":[],"relativePath":"api/effects.md","filePath":"api/effects.md","lastUpdated":1768626356000}'),E={name:"api/effects.md"};function k(A,s,f,_,b,u){const t=o("Mermaid");return e(),c("div",null,[s[5]||(s[5]=n("h1",{id:"effects-reference",tabindex:"-1"},[i("Effects Reference "),n("a",{class:"header-anchor",href:"#effects-reference","aria-label":'Permalink to "Effects Reference"'},"​")],-1)),s[6]||(s[6]=n("p",null,"Effects are the fundamental unit of authorization in the Authority Kernel.",-1)),s[7]||(s[7]=n("h2",{id:"effect-processing-pipeline",tabindex:"-1"},[i("Effect Processing Pipeline "),n("a",{class:"header-anchor",href:"#effect-processing-pipeline","aria-label":'Permalink to "Effect Processing Pipeline"'},"​")],-1)),(e(),l(d,null,{default:a(()=>[p(t,{id:"mermaid-9",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20subgraph%20%22Input%22%0A%20%20%20%20%20%20%20%20POSIX%5BPOSIX%20Syscall%5D%0A%20%20%20%20%20%20%20%20AK_SYS%5BAK%20Syscall%5D%0A%20%20%20%20%20%20%20%20TOOL%5BTool%20Call%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Effect%20Creation%22%0A%20%20%20%20%20%20%20%20BUILD%5BBuild%20Effect%5D%0A%20%20%20%20%20%20%20%20CANON%5BCanonicalize%20Target%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Authorization%22%0A%20%20%20%20%20%20%20%20GATE%5BAuthority%20Gate%5D%0A%20%20%20%20%20%20%20%20CAP%5BCapability%20Check%5D%0A%20%20%20%20%20%20%20%20POLICY%5BPolicy%20Match%5D%0A%20%20%20%20%20%20%20%20BUDGET%5BBudget%20Check%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Execution%22%0A%20%20%20%20%20%20%20%20EXEC%5BExecute%5D%0A%20%20%20%20%20%20%20%20AUDIT%5BAudit%20Log%5D%0A%20%20%20%20end%0A%0A%20%20%20%20POSIX%20--%3E%20BUILD%0A%20%20%20%20AK_SYS%20--%3E%20BUILD%0A%20%20%20%20TOOL%20--%3E%20BUILD%0A%0A%20%20%20%20BUILD%20--%3E%20CANON%0A%20%20%20%20CANON%20--%3E%20GATE%0A%20%20%20%20GATE%20--%3E%20CAP%0A%20%20%20%20CAP%20--%3E%20POLICY%0A%20%20%20%20POLICY%20--%3E%20BUDGET%0A%20%20%20%20BUDGET%20--%3E%20EXEC%0A%20%20%20%20EXEC%20--%3E%20AUDIT%0A%0A%20%20%20%20style%20GATE%20fill%3A%23e74c3c%2Ccolor%3A%23fff%0A%20%20%20%20style%20CANON%20fill%3A%233498db%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[0]||(s[0]=[i(" Loading... ",-1)])]),_:1})),s[8]||(s[8]=r('<h2 id="what-is-an-effect" tabindex="-1">What is an Effect? <a class="header-anchor" href="#what-is-an-effect" aria-label="Permalink to &quot;What is an Effect?&quot;">​</a></h2><p>An <strong>effect</strong> is any operation that:</p><ul><li>Accesses external resources (files, network)</li><li>Modifies state (heap, audit log)</li><li>Consumes resources (tokens, API calls)</li></ul><p>POSIX syscalls are translated into effects before policy evaluation.</p><h2 id="effect-types" tabindex="-1">Effect Types <a class="header-anchor" href="#effect-types" aria-label="Permalink to &quot;Effect Types&quot;">​</a></h2>',5)),(e(),l(d,null,{default:a(()=>[p(t,{id:"mermaid-39",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20subgraph%20%22Filesystem%20(0x01xx)%22%0A%20%20%20%20%20%20%20%20FS_OPEN%5BFS_OPEN%3Cbr%2F%3E0x0100%5D%0A%20%20%20%20%20%20%20%20FS_UNLINK%5BFS_UNLINK%3Cbr%2F%3E0x0101%5D%0A%20%20%20%20%20%20%20%20FS_RENAME%5BFS_RENAME%3Cbr%2F%3E0x0102%5D%0A%20%20%20%20%20%20%20%20FS_MKDIR%5BFS_MKDIR%3Cbr%2F%3E0x0103%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Network%20(0x02xx)%22%0A%20%20%20%20%20%20%20%20NET_CONNECT%5BNET_CONNECT%3Cbr%2F%3E0x0200%5D%0A%20%20%20%20%20%20%20%20NET_DNS%5BNET_DNS_RESOLVE%3Cbr%2F%3E0x0201%5D%0A%20%20%20%20%20%20%20%20NET_BIND%5BNET_BIND%3Cbr%2F%3E0x0202%5D%0A%20%20%20%20%20%20%20%20NET_LISTEN%5BNET_LISTEN%3Cbr%2F%3E0x0203%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Process%20(0x03xx)%22%0A%20%20%20%20%20%20%20%20PROC_SPAWN%5BPROC_SPAWN%3Cbr%2F%3E0x0300%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Agentic%20(0x04xx)%22%0A%20%20%20%20%20%20%20%20TOOL_CALL%5BTOOL_CALL%3Cbr%2F%3E0x0400%5D%0A%20%20%20%20%20%20%20%20WASM_INVOKE%5BWASM_INVOKE%3Cbr%2F%3E0x0401%5D%0A%20%20%20%20%20%20%20%20INFER%5BINFER%3Cbr%2F%3E0x0402%5D%0A%20%20%20%20end%0A%0A%20%20%20%20style%20FS_OPEN%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20NET_CONNECT%20fill%3A%239b59b6%2Ccolor%3A%23fff%0A%20%20%20%20style%20PROC_SPAWN%20fill%3A%23e74c3c%2Ccolor%3A%23fff%0A%20%20%20%20style%20TOOL_CALL%20fill%3A%23f39c12%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[1]||(s[1]=[i(" Loading... ",-1)])]),_:1})),s[9]||(s[9]=r(`<h3 id="filesystem-effects-0x01xx" tabindex="-1">Filesystem Effects (0x01xx) <a class="header-anchor" href="#filesystem-effects-0x01xx" aria-label="Permalink to &quot;Filesystem Effects (0x01xx)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Effect</th><th>Code</th><th>Description</th></tr></thead><tbody><tr><td><code>AK_E_FS_OPEN</code></td><td>0x0100</td><td>Open file for read/write</td></tr><tr><td><code>AK_E_FS_UNLINK</code></td><td>0x0101</td><td>Delete file</td></tr><tr><td><code>AK_E_FS_RENAME</code></td><td>0x0102</td><td>Rename/move file</td></tr><tr><td><code>AK_E_FS_MKDIR</code></td><td>0x0103</td><td>Create directory</td></tr></tbody></table><h3 id="network-effects-0x02xx" tabindex="-1">Network Effects (0x02xx) <a class="header-anchor" href="#network-effects-0x02xx" aria-label="Permalink to &quot;Network Effects (0x02xx)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Effect</th><th>Code</th><th>Description</th></tr></thead><tbody><tr><td><code>AK_E_NET_CONNECT</code></td><td>0x0200</td><td>Establish connection</td></tr><tr><td><code>AK_E_NET_DNS_RESOLVE</code></td><td>0x0201</td><td>DNS lookup</td></tr><tr><td><code>AK_E_NET_BIND</code></td><td>0x0202</td><td>Bind to port</td></tr><tr><td><code>AK_E_NET_LISTEN</code></td><td>0x0203</td><td>Listen for connections</td></tr></tbody></table><h3 id="process-effects-0x03xx" tabindex="-1">Process Effects (0x03xx) <a class="header-anchor" href="#process-effects-0x03xx" aria-label="Permalink to &quot;Process Effects (0x03xx)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Effect</th><th>Code</th><th>Description</th></tr></thead><tbody><tr><td><code>AK_E_PROC_SPAWN</code></td><td>0x0300</td><td>Create child agent</td></tr></tbody></table><h3 id="agentic-effects-0x04xx" tabindex="-1">Agentic Effects (0x04xx) <a class="header-anchor" href="#agentic-effects-0x04xx" aria-label="Permalink to &quot;Agentic Effects (0x04xx)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Effect</th><th>Code</th><th>Description</th></tr></thead><tbody><tr><td><code>AK_E_TOOL_CALL</code></td><td>0x0400</td><td>Execute tool</td></tr><tr><td><code>AK_E_WASM_INVOKE</code></td><td>0x0401</td><td>Run WASM module</td></tr><tr><td><code>AK_E_INFER</code></td><td>0x0402</td><td>LLM inference</td></tr></tbody></table><h2 id="effect-request-structure" tabindex="-1">Effect Request Structure <a class="header-anchor" href="#effect-request-structure" aria-label="Permalink to &quot;Effect Request Structure&quot;">​</a></h2><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ak_effect_req {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    ak_effect_op_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> op;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    u64 trace_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pid_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pid;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    tid_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tid;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* Canonical target string:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * - FS: absolute normalized path</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * - NET_CONNECT: &quot;ip:1.2.3.4:443&quot; OR &quot;dns:example.com:443&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * - NET_DNS_RESOLVE: &quot;dns:example.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * - TOOL: &quot;tool:&lt;name&gt;:&lt;version&gt;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * - INFER: &quot;model:&lt;name&gt;:&lt;version&gt;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* Compact encoded params (JSON) */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    u8 </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4096</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    u32 params_len;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* Budgets/limits */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        u64 cpu_ns;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        u64 wall_ns;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        u64 bytes;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        u64 tokens;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } budget;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ak_effect_req_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="authorization-decision" tabindex="-1">Authorization Decision <a class="header-anchor" href="#authorization-decision" aria-label="Permalink to &quot;Authorization Decision&quot;">​</a></h2><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ak_decision {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    boolean allow;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reason_code;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> errno_equiv;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> missing_cap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> suggested_snippet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    u64 trace_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> detail</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ak_decision_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="denial-reasons" tabindex="-1">Denial Reasons <a class="header-anchor" href="#denial-reasons" aria-label="Permalink to &quot;Denial Reasons&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Code</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td><code>AK_DENY_NO_POLICY</code></td><td>No policy loaded</td></tr><tr><td>2</td><td><code>AK_DENY_NO_CAP</code></td><td>Capability required but missing</td></tr><tr><td>3</td><td><code>AK_DENY_CAP_EXPIRED</code></td><td>Capability TTL exceeded</td></tr><tr><td>4</td><td><code>AK_DENY_PATTERN_MISMATCH</code></td><td>Target doesn&#39;t match policy pattern</td></tr><tr><td>5</td><td><code>AK_DENY_BUDGET_EXCEEDED</code></td><td>Would exceed resource budget</td></tr><tr><td>6</td><td><code>AK_DENY_RATE_LIMITED</code></td><td>Rate limit exceeded</td></tr><tr><td>7</td><td><code>AK_DENY_TAINT</code></td><td>Taint level too high for sink</td></tr></tbody></table><h2 id="canonicalization" tabindex="-1">Canonicalization <a class="header-anchor" href="#canonicalization" aria-label="Permalink to &quot;Canonicalization&quot;">​</a></h2>`,15)),(e(),l(d,null,{default:a(()=>[p(t,{id:"mermaid-360",class:"mermaid",graph:"flowchart%20TB%0A%20%20%20%20subgraph%20%22Filesystem%20Canonicalization%22%0A%20%20%20%20%20%20%20%20FS_IN%5B%22.%2Ffoo%2F..%2Fbar%2Ffile.txt%22%5D%0A%20%20%20%20%20%20%20%20FS_CWD%5BCWD%3A%20%2Fapp%5D%0A%20%20%20%20%20%20%20%20FS_ABS%5BAbsolute%3A%20%2Fapp%2F.%2Ffoo%2F..%2Fbar%2Ffile.txt%5D%0A%20%20%20%20%20%20%20%20FS_CLEAN%5BClean%3A%20%2Fapp%2Fbar%2Ffile.txt%5D%0A%20%20%20%20%20%20%20%20FS_OUT%5B%22%2Fapp%2Fbar%2Ffile.txt%22%5D%0A%0A%20%20%20%20%20%20%20%20FS_IN%20--%3E%20FS_CWD%0A%20%20%20%20%20%20%20%20FS_CWD%20--%3E%20FS_ABS%0A%20%20%20%20%20%20%20%20FS_ABS%20--%3E%20FS_CLEAN%0A%20%20%20%20%20%20%20%20FS_CLEAN%20--%3E%20FS_OUT%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Network%20Canonicalization%22%0A%20%20%20%20%20%20%20%20NET_IN%5B%22%3A%3Affff%3A192.168.1.1%3A443%22%5D%0A%20%20%20%20%20%20%20%20NET_MAP%5BIPv4-mapped%20detection%5D%0A%20%20%20%20%20%20%20%20NET_NORM%5BNormalize%20to%20IPv4%5D%0A%20%20%20%20%20%20%20%20NET_OUT%5B%22ip%3A192.168.1.1%3A443%22%5D%0A%0A%20%20%20%20%20%20%20%20NET_IN%20--%3E%20NET_MAP%0A%20%20%20%20%20%20%20%20NET_MAP%20--%3E%20NET_NORM%0A%20%20%20%20%20%20%20%20NET_NORM%20--%3E%20NET_OUT%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22DNS%20Canonicalization%22%0A%20%20%20%20%20%20%20%20DNS_IN%5Bexample.com%5D%0A%20%20%20%20%20%20%20%20DNS_FMT%5BAdd%20prefix%5D%0A%20%20%20%20%20%20%20%20DNS_OUT%5B%22dns%3Aexample.com%22%5D%0A%0A%20%20%20%20%20%20%20%20DNS_IN%20--%3E%20DNS_FMT%0A%20%20%20%20%20%20%20%20DNS_FMT%20--%3E%20DNS_OUT%0A%20%20%20%20end%0A%0A%20%20%20%20style%20FS_OUT%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20NET_OUT%20fill%3A%239b59b6%2Ccolor%3A%23fff%0A%20%20%20%20style%20DNS_OUT%20fill%3A%232ecc71%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[2]||(s[2]=[i(" Loading... ",-1)])]),_:1})),s[10]||(s[10]=r('<p>All targets are canonicalized before policy matching:</p><h3 id="filesystem-paths" tabindex="-1">Filesystem Paths <a class="header-anchor" href="#filesystem-paths" aria-label="Permalink to &quot;Filesystem Paths&quot;">​</a></h3><ol><li>Convert relative to absolute (using cwd)</li><li>Remove <code>.</code> segments</li><li>Resolve <code>..</code> segments</li><li>No trailing slashes (except root)</li></ol><p><strong>Example:</strong></p><ul><li>Input: <code>./foo/../bar/file.txt</code></li><li>CWD: <code>/app</code></li><li>Output: <code>/app/bar/file.txt</code></li></ul><h3 id="network-addresses" tabindex="-1">Network Addresses <a class="header-anchor" href="#network-addresses" aria-label="Permalink to &quot;Network Addresses&quot;">​</a></h3><ol><li>IPv4-mapped IPv6 normalized to IPv4</li><li>Port always included</li><li>Format: <code>ip:&lt;addr&gt;:&lt;port&gt;</code> or <code>dns:&lt;host&gt;:&lt;port&gt;</code></li></ol><p><strong>Examples:</strong></p><ul><li><code>::ffff:192.168.1.1:443</code> → <code>ip:192.168.1.1:443</code></li><li><code>example.com:8080</code> → <code>dns:example.com:8080</code></li></ul><h3 id="dns-targets" tabindex="-1">DNS Targets <a class="header-anchor" href="#dns-targets" aria-label="Permalink to &quot;DNS Targets&quot;">​</a></h3><p>Format: <code>dns:&lt;hostname&gt;</code></p><p><strong>Example:</strong></p><ul><li><code>example.com</code> → <code>dns:example.com</code></li></ul><h2 id="effect-flow" tabindex="-1">Effect Flow <a class="header-anchor" href="#effect-flow" aria-label="Permalink to &quot;Effect Flow&quot;">​</a></h2>',14)),(e(),l(d,null,{default:a(()=>[p(t,{id:"mermaid-463",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20SYSCALL%5B%22POSIX%20Syscall%3Cbr%2F%3Eopen('%2Fetc%2Fhosts'%2C%20O_RDONLY)%22%5D%0A%20%20%20%20BUILD%5B%22Build%20Effect%3Cbr%2F%3EAK_E_FS_OPEN%2C%20target%3D'%2Fetc%2Fhosts'%22%5D%0A%20%20%20%20CANON%5B%22Canonicalize%3Cbr%2F%3ENormalize%20path%22%5D%0A%20%20%20%20POLICY%7B%22Policy%20Check%3Cbr%2F%3EDoes%20fs.read%20match%20'%2Fetc%2Fhosts'%3F%22%7D%0A%20%20%20%20ALLOW%5BALLOW%5D%0A%20%20%20%20DENY%5B%22DENY%3Cbr%2F%3E%2B%20reason%2C%20suggestion%22%5D%0A%20%20%20%20EXEC%5B%22Execute%3Cbr%2F%3EPerform%20actual%20open()%22%5D%0A%20%20%20%20AUDIT%5B%22Audit%3Cbr%2F%3ELog%20entry%20appended%22%5D%0A%0A%20%20%20%20SYSCALL%20--%3E%20BUILD%0A%20%20%20%20BUILD%20--%3E%20CANON%0A%20%20%20%20CANON%20--%3E%20POLICY%0A%20%20%20%20POLICY%20--%3E%7CMatch%7C%20ALLOW%0A%20%20%20%20POLICY%20--%3E%7CNo%20Match%7C%20DENY%0A%20%20%20%20ALLOW%20--%3E%20EXEC%0A%20%20%20%20EXEC%20--%3E%20AUDIT%0A%0A%20%20%20%20style%20SYSCALL%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20ALLOW%20fill%3A%2327ae60%2Ccolor%3A%23fff%0A%20%20%20%20style%20DENY%20fill%3A%23c0392b%2Ccolor%3A%23fff%0A%20%20%20%20style%20AUDIT%20fill%3A%232ecc71%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[3]||(s[3]=[i(" Loading... ",-1)])]),_:1})),s[11]||(s[11]=r(`<h2 id="building-effects-from-syscalls" tabindex="-1">Building Effects from Syscalls <a class="header-anchor" href="#building-effects-from-syscalls" aria-label="Permalink to &quot;Building Effects from Syscalls&quot;">​</a></h2><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* Helper functions */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ak_effect_from_open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ak_effect_req_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> flags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ak_effect_from_connect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ak_effect_req_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sockaddr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">addr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">socklen_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ak_effect_from_unlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ak_effect_req_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="policy-matching" tabindex="-1">Policy Matching <a class="header-anchor" href="#policy-matching" aria-label="Permalink to &quot;Policy Matching&quot;">​</a></h2>`,3)),(e(),l(d,null,{default:a(()=>[p(t,{id:"mermaid-471",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20subgraph%20%22Effect%20to%20Policy%20Mapping%22%0A%20%20%20%20%20%20%20%20direction%20LR%0A%20%20%20%20%20%20%20%20EFF_FS%5BAK_E_FS_OPEN%3Cbr%2F%3EO_RDONLY%5D%20--%3E%20POL_READ%5Bfs.read%20patterns%5D%0A%20%20%20%20%20%20%20%20EFF_FSW%5BAK_E_FS_OPEN%3Cbr%2F%3EO_WRONLY%5D%20--%3E%20POL_WRITE%5Bfs.write%20patterns%5D%0A%20%20%20%20%20%20%20%20EFF_NET%5BAK_E_NET_CONNECT%5D%20--%3E%20POL_CONN%5Bnet.connect%20patterns%5D%0A%20%20%20%20%20%20%20%20EFF_DNS%5BAK_E_NET_DNS_RESOLVE%5D%20--%3E%20POL_DNS%5Bnet.dns%20patterns%5D%0A%20%20%20%20%20%20%20%20EFF_TOOL%5BAK_E_TOOL_CALL%5D%20--%3E%20POL_TOOL%5Btools.allow%20patterns%5D%0A%20%20%20%20%20%20%20%20EFF_INFER%5BAK_E_INFER%5D%20--%3E%20POL_INFER%5Binfer.models%20patterns%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Pattern%20Matching%22%0A%20%20%20%20%20%20%20%20TARGET%5B%22%2Fapp%2Fdata%2Ffile.txt%22%5D%0A%0A%20%20%20%20%20%20%20%20P1%5B%22Pattern%3A%20%2Fapp%2F**%22%5D%20--%3E%7CMATCH%7C%20TARGET%0A%20%20%20%20%20%20%20%20P2%5B%22Pattern%3A%20%2Fapp%2Fdata%2F*%22%5D%20--%3E%7CMATCH%7C%20TARGET%0A%20%20%20%20%20%20%20%20P3%5B%22Pattern%3A%20%2Ftmp%2F**%22%5D%20--%3E%7CNO%20MATCH%7C%20TARGET%0A%20%20%20%20end%0A%0A%20%20%20%20style%20POL_READ%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20POL_WRITE%20fill%3A%23e74c3c%2Ccolor%3A%23fff%0A%20%20%20%20style%20POL_CONN%20fill%3A%239b59b6%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[4]||(s[4]=[i(" Loading... ",-1)])]),_:1})),s[12]||(s[12]=r(`<p>Effects are matched against policy rules:</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;read&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/etc/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Matches AK_E_FS_OPEN with O_RDONLY</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/tmp/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Matches AK_E_FS_OPEN with O_WRONLY</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Pattern matching uses glob-style syntax:</p><ul><li><code>*</code> matches any characters except <code>/</code></li><li><code>**</code> matches any characters including <code>/</code></li><li>Exact strings require exact match</li></ul>`,4))])}const y=h(E,[["render",k]]);export{F as __pageData,y as default};
