import{_ as d,C as h,c as E,o as e,ah as o,b as l,j as p,w as a,a as i,G as t,ai as r}from"./chunks/framework.CpSv75ol.js";const C=JSON.parse('{"title":"Policy Overview","description":"","frontmatter":{},"headers":[],"relativePath":"policy/index.md","filePath":"policy/index.md","lastUpdated":1768626356000}'),c={name:"policy/index.md"};function k(u,s,A,g,b,m){const n=h("Mermaid");return e(),E("div",null,[s[7]||(s[7]=o('<h1 id="policy-overview" tabindex="-1">Policy Overview <a class="header-anchor" href="#policy-overview" aria-label="Permalink to &quot;Policy Overview&quot;">​</a></h1><p>The Authority Kernel uses a <strong>deny-by-default</strong> policy model:</p><ul><li>If no policy is loaded, ALL operations are denied</li><li>If a policy is loaded, only explicitly allowed operations succeed</li><li>Missing rules for a category = deny that category</li></ul><h2 id="policy-evaluation-flow" tabindex="-1">Policy Evaluation Flow <a class="header-anchor" href="#policy-evaluation-flow" aria-label="Permalink to &quot;Policy Evaluation Flow&quot;">​</a></h2>',4)),(e(),l(r,null,{default:a(()=>[t(n,{id:"mermaid-26",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20REQ%5BEffect%20Request%5D%20--%3E%20LOAD%7BPolicy%20Loaded%3F%7D%0A%0A%20%20%20%20LOAD%20--%3E%7CNo%7C%20DENY1%5BDENY%3Cbr%2F%3ENo%20policy%20found%5D%0A%20%20%20%20LOAD%20--%3E%7CYes%7C%20MATCH%7BPattern%20Match%3F%7D%0A%0A%20%20%20%20MATCH%20--%3E%7CNo%20Match%7C%20DENY2%5BDENY%3Cbr%2F%3ENo%20rule%20covers%20request%5D%0A%20%20%20%20MATCH%20--%3E%7CMatch%20Found%7C%20RULE%7BRule%20Decision%3F%7D%0A%0A%20%20%20%20RULE%20--%3E%7CDENY%7C%20DENY3%5BDENY%3Cbr%2F%3EExplicit%20deny%20rule%5D%0A%20%20%20%20RULE%20--%3E%7CALLOW%7C%20BUDGET%7BBudget%20OK%3F%7D%0A%20%20%20%20RULE%20--%3E%7CREQUIRE_APPROVAL%7C%20APPROVE%5BWait%20for%20Approval%5D%0A%0A%20%20%20%20BUDGET%20--%3E%7CExceeded%7C%20DENY4%5BDENY%3Cbr%2F%3EBudget%20exceeded%5D%0A%20%20%20%20BUDGET%20--%3E%7COK%7C%20ALLOW%5BALLOW%3Cbr%2F%3EExecute%20operation%5D%0A%0A%20%20%20%20style%20DENY1%20fill%3A%23c0392b%2Ccolor%3A%23fff%0A%20%20%20%20style%20DENY2%20fill%3A%23c0392b%2Ccolor%3A%23fff%0A%20%20%20%20style%20DENY3%20fill%3A%23c0392b%2Ccolor%3A%23fff%0A%20%20%20%20style%20DENY4%20fill%3A%23c0392b%2Ccolor%3A%23fff%0A%20%20%20%20style%20ALLOW%20fill%3A%2327ae60%2Ccolor%3A%23fff%0A%20%20%20%20style%20APPROVE%20fill%3A%23f39c12%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[0]||(s[0]=[i(" Loading... ",-1)])]),_:1})),s[8]||(s[8]=p("h2",{id:"policy-structure",tabindex:"-1"},[i("Policy Structure "),p("a",{class:"header-anchor",href:"#policy-structure","aria-label":'Permalink to "Policy Structure"'},"​")],-1)),(e(),l(r,null,{default:a(()=>[t(n,{id:"mermaid-30",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20subgraph%20%22Policy%20File%22%0A%20%20%20%20%20%20%20%20VER%5Bversion%3A%201.0%5D%0A%0A%20%20%20%20%20%20%20%20subgraph%20FS%5BFilesystem%20Rules%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20FS_R%5Bread%3A%20patterns%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20FS_W%5Bwrite%3A%20patterns%5D%0A%20%20%20%20%20%20%20%20end%0A%0A%20%20%20%20%20%20%20%20subgraph%20NET%5BNetwork%20Rules%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20NET_DNS%5Bdns%3A%20domains%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20NET_CON%5Bconnect%3A%20targets%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20NET_BIND%5Bbind%3A%20addresses%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20NET_LIST%5Blisten%3A%20addresses%5D%0A%20%20%20%20%20%20%20%20end%0A%0A%20%20%20%20%20%20%20%20subgraph%20TOOLS%5BTool%20Rules%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20T_ALLOW%5Ballow%3A%20names%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20T_DENY%5Bdeny%3A%20names%5D%0A%20%20%20%20%20%20%20%20end%0A%0A%20%20%20%20%20%20%20%20subgraph%20INFER%5BInference%20Rules%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20I_MODELS%5Bmodels%3A%20patterns%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20I_TOKENS%5Bmax_tokens%3A%20limit%5D%0A%20%20%20%20%20%20%20%20end%0A%0A%20%20%20%20%20%20%20%20subgraph%20BUDGETS%5BBudget%20Limits%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20B_CALLS%5Btool_calls%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20B_TOKENS%5Btokens%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20B_TIME%5Bwall_time_ms%5D%0A%20%20%20%20%20%20%20%20end%0A%0A%20%20%20%20%20%20%20%20PROFILES%5Bprofiles%3A%20includes%5D%0A%20%20%20%20end%0A%0A%20%20%20%20style%20VER%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20FS%20fill%3A%232ecc71%2Ccolor%3A%23fff%0A%20%20%20%20style%20NET%20fill%3A%239b59b6%2Ccolor%3A%23fff%0A%20%20%20%20style%20TOOLS%20fill%3A%23e74c3c%2Ccolor%3A%23fff%0A%20%20%20%20style%20INFER%20fill%3A%23f39c12%2Ccolor%3A%23fff%0A%20%20%20%20style%20BUDGETS%20fill%3A%231abc9c%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[1]||(s[1]=[i(" Loading... ",-1)])]),_:1})),s[9]||(s[9]=o('<h2 id="policy-formats" tabindex="-1">Policy Formats <a class="header-anchor" href="#policy-formats" aria-label="Permalink to &quot;Policy Formats&quot;">​</a></h2><p>Authority Nanos supports two policy formats:</p><ul><li><a href="/policy/json-format">JSON Format</a> - Primary format for P0</li><li><a href="/policy/toml-format">TOML Format</a> - Human-friendly alternative (P1)</li></ul><h2 id="policy-location" tabindex="-1">Policy Location <a class="header-anchor" href="#policy-location" aria-label="Permalink to &quot;Policy Location&quot;">​</a></h2>',4)),(e(),l(r,null,{default:a(()=>[t(n,{id:"mermaid-52",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20subgraph%20%22Development%22%0A%20%20%20%20%20%20%20%20INITRD%5B%2Fak%2Fpolicy.json%3Cbr%2F%3Ein%20initrd%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Production%22%0A%20%20%20%20%20%20%20%20EMBED%5BEmbedded%20in%20kernel%3Cbr%2F%3Eat%20compile%20time%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Runtime%22%0A%20%20%20%20%20%20%20%20LOADER%5BPolicy%20Loader%5D%0A%20%20%20%20%20%20%20%20CACHE%5BCached%20Policy%5D%0A%20%20%20%20end%0A%0A%20%20%20%20INITRD%20--%3E%20LOADER%0A%20%20%20%20EMBED%20--%3E%20LOADER%0A%20%20%20%20LOADER%20--%3E%20CACHE%0A%0A%20%20%20%20style%20INITRD%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20EMBED%20fill%3A%23e74c3c%2Ccolor%3A%23fff%0A%20%20%20%20style%20CACHE%20fill%3A%232ecc71%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[2]||(s[2]=[i(" Loading... ",-1)])]),_:1})),s[10]||(s[10]=o(`<h3 id="development-initrd" tabindex="-1">Development (Initrd) <a class="header-anchor" href="#development-initrd" aria-label="Permalink to &quot;Development (Initrd)&quot;">​</a></h3><p>Place your policy at <code>/ak/policy.json</code> in the initrd:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initrd/ak</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> policy.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initrd/ak/policy.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="production-embedded" tabindex="-1">Production (Embedded) <a class="header-anchor" href="#production-embedded" aria-label="Permalink to &quot;Production (Embedded)&quot;">​</a></h3><p>Compile policy into the kernel image:</p><div class="language-makefile vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">makefile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CFLAGS += -DCONFIG_AK_EMBEDDED_POLICY=1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="pattern-matching" tabindex="-1">Pattern Matching <a class="header-anchor" href="#pattern-matching" aria-label="Permalink to &quot;Pattern Matching&quot;">​</a></h2>`,7)),(e(),l(r,null,{default:a(()=>[t(n,{id:"mermaid-70",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20subgraph%20%22Filesystem%20Pattern%20Matching%22%0A%20%20%20%20%20%20%20%20PATH%5B%2Fapp%2Fdata%2Ffile.txt%5D%0A%0A%20%20%20%20%20%20%20%20P1%5B%22%2Fapp%2F**%22%5D%20--%3E%7CMATCH%7C%20PATH%0A%20%20%20%20%20%20%20%20P2%5B%22%2Fapp%2Fdata%2F*%22%5D%20--%3E%7CMATCH%7C%20PATH%0A%20%20%20%20%20%20%20%20P3%5B%22%2Fapp%2Fdata%2Ffile.txt%22%5D%20--%3E%7CMATCH%7C%20PATH%0A%20%20%20%20%20%20%20%20P4%5B%22%2Ftmp%2F**%22%5D%20--%3E%7CNO%20MATCH%7C%20PATH%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Network%20Pattern%20Matching%22%0A%20%20%20%20%20%20%20%20TARGET%5Bdns%3Aapi.github.com%3A443%5D%0A%0A%20%20%20%20%20%20%20%20N1%5B%22dns%3Aapi.github.com%3A443%22%5D%20--%3E%7CMATCH%7C%20TARGET%0A%20%20%20%20%20%20%20%20N2%5B%22dns%3A*.github.com%3A443%22%5D%20--%3E%7CMATCH%7C%20TARGET%0A%20%20%20%20%20%20%20%20N3%5B%22dns%3A*%3A443%22%5D%20--%3E%7CMATCH%7C%20TARGET%0A%20%20%20%20%20%20%20%20N4%5B%22ip%3A*%3A443%22%5D%20--%3E%7CNO%20MATCH%7C%20TARGET%0A%20%20%20%20end%0A%0A%20%20%20%20style%20PATH%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20TARGET%20fill%3A%239b59b6%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[3]||(s[3]=[i(" Loading... ",-1)])]),_:1})),s[11]||(s[11]=o(`<h2 id="quick-reference" tabindex="-1">Quick Reference <a class="header-anchor" href="#quick-reference" aria-label="Permalink to &quot;Quick Reference&quot;">​</a></h2><h3 id="filesystem-rules" tabindex="-1">Filesystem Rules <a class="header-anchor" href="#filesystem-rules" aria-label="Permalink to &quot;Filesystem Rules&quot;">​</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;read&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/app/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/lib/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/tmp/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="network-rules" tabindex="-1">Network Rules <a class="header-anchor" href="#network-rules" aria-label="Permalink to &quot;Network Rules&quot;">​</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api.github.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*.googleapis.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;connect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dns:api.github.com:443&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ip:10.0.0.0/8:5432&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;bind&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ip:0.0.0.0:8080&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;listen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ip:0.0.0.0:8080&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="tool-rules" tabindex="-1">Tool Rules <a class="header-anchor" href="#tool-rules" aria-label="Permalink to &quot;Tool Rules&quot;">​</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;tools&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;allow&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http_get&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;file_read&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;deny&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;shell_exec&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="inference-rules" tabindex="-1">Inference Rules <a class="header-anchor" href="#inference-rules" aria-label="Permalink to &quot;Inference Rules&quot;">​</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;infer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;models&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gpt-4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;claude-*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;max_tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="budgets" tabindex="-1">Budgets <a class="header-anchor" href="#budgets" aria-label="Permalink to &quot;Budgets&quot;">​</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;budgets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tool_calls&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;wall_time_ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="budget-enforcement" tabindex="-1">Budget Enforcement <a class="header-anchor" href="#budget-enforcement" aria-label="Permalink to &quot;Budget Enforcement&quot;">​</a></h2>`,12)),(e(),l(r,null,{default:a(()=>[t(n,{id:"mermaid-97",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20Agent%0A%20%20%20%20participant%20Gate%20as%20Authority%20Gate%0A%20%20%20%20participant%20Budget%20as%20Budget%20Controller%0A%20%20%20%20participant%20Op%20as%20Operation%0A%0A%20%20%20%20Agent-%3E%3EGate%3A%20Request%20(cost%3D10%20tokens)%0A%20%20%20%20Gate-%3E%3EBudget%3A%20Check%20budget%0A%0A%20%20%20%20Budget-%3E%3EBudget%3A%20current%3D90%2C%20limit%3D100%0A%20%20%20%20Budget-%3E%3EBudget%3A%2090%20%2B%2010%20%3C%3D%20100%3F%0A%0A%20%20%20%20alt%20Within%20Budget%0A%20%20%20%20%20%20%20%20Budget--%3E%3EGate%3A%20OK%0A%20%20%20%20%20%20%20%20Gate-%3E%3EOp%3A%20Execute%0A%20%20%20%20%20%20%20%20Op--%3E%3EGate%3A%20Success%0A%20%20%20%20%20%20%20%20Gate-%3E%3EBudget%3A%20Commit%20cost%0A%20%20%20%20%20%20%20%20Budget-%3E%3EBudget%3A%20current%20%3D%20100%0A%20%20%20%20%20%20%20%20Gate--%3E%3EAgent%3A%20Success%0A%20%20%20%20else%20Exceeds%20Budget%0A%20%20%20%20%20%20%20%20Budget--%3E%3EGate%3A%20E_BUDGET_EXCEEDED%0A%20%20%20%20%20%20%20%20Gate--%3E%3EAgent%3A%20Error%20(budget%20exceeded)%0A%20%20%20%20end%0A"})]),fallback:a(()=>[...s[4]||(s[4]=[i(" Loading... ",-1)])]),_:1})),s[12]||(s[12]=p("h2",{id:"profile-inheritance",tabindex:"-1"},[i("Profile Inheritance "),p("a",{class:"header-anchor",href:"#profile-inheritance","aria-label":'Permalink to "Profile Inheritance"'},"​")],-1)),(e(),l(r,null,{default:a(()=>[t(n,{id:"mermaid-101",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20subgraph%20%22Built-in%20Profiles%22%0A%20%20%20%20%20%20%20%20TIER1%5Btier1-musl%3Cbr%2F%3EMinimal%5D%0A%20%20%20%20%20%20%20%20TIER2%5Btier2-glibc%3Cbr%2F%3EDynamic%20linking%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22User%20Policy%22%0A%20%20%20%20%20%20%20%20USER%5BUser%20Rules%5D%0A%20%20%20%20%20%20%20%20PROFILES%5Bprofiles%3A%20tier1-musl%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Effective%20Policy%22%0A%20%20%20%20%20%20%20%20MERGED%5BMerged%20Rules%5D%0A%20%20%20%20end%0A%0A%20%20%20%20TIER1%20--%3E%20MERGED%0A%20%20%20%20USER%20--%3E%20MERGED%0A%20%20%20%20PROFILES%20-.-%3E%7Cincludes%7C%20TIER1%0A%0A%20%20%20%20style%20TIER1%20fill%3A%233498db%2Ccolor%3A%23fff%0A%20%20%20%20style%20TIER2%20fill%3A%239b59b6%2Ccolor%3A%23fff%0A%20%20%20%20style%20MERGED%20fill%3A%232ecc71%2Ccolor%3A%23fff%0A"})]),fallback:a(()=>[...s[5]||(s[5]=[i(" Loading... ",-1)])]),_:1})),s[13]||(s[13]=p("h2",{id:"denial-debugging",tabindex:"-1"},[i("Denial Debugging "),p("a",{class:"header-anchor",href:"#denial-debugging","aria-label":'Permalink to "Denial Debugging"'},"​")],-1)),(e(),l(r,null,{default:a(()=>[t(n,{id:"mermaid-105",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20Agent%0A%20%20%20%20participant%20AK%20as%20Authority%20Kernel%0A%20%20%20%20participant%20Console%0A%20%20%20%20participant%20LastError%20as%20Last%20Error%20Buffer%0A%0A%20%20%20%20Agent-%3E%3EAK%3A%20open(%22%2Fetc%2Fsecret%22%2C%20O_RDONLY)%0A%20%20%20%20AK-%3E%3EAK%3A%20Check%20policy%0A%20%20%20%20AK-%3E%3EAK%3A%20No%20match%20for%20%2Fetc%2Fsecret%0A%0A%20%20%20%20AK-%3E%3EConsole%3A%20AK%20DENY%20FS_OPEN%20%2Fetc%2Fsecret...%0A%20%20%20%20AK-%3E%3ELastError%3A%20Store%20denial%20details%0A%0A%20%20%20%20AK--%3E%3EAgent%3A%20-EACCES%0A%0A%20%20%20%20Agent-%3E%3EAK%3A%20syscall(AK_SYS_LAST_ERROR)%0A%20%20%20%20AK-%3E%3ELastError%3A%20Read%20stored%20denial%0A%20%20%20%20LastError--%3E%3EAgent%3A%20JSON%20with%20details%0A"})]),fallback:a(()=>[...s[6]||(s[6]=[i(" Loading... ",-1)])]),_:1})),s[14]||(s[14]=o(`<h3 id="console-messages" tabindex="-1">Console Messages <a class="header-anchor" href="#console-messages" aria-label="Permalink to &quot;Console Messages&quot;">​</a></h3><p>When an operation is denied:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AK DENY FS_OPEN /etc/secret missing fs.read. Fix: read = [&quot;/etc/secret&quot;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="last-error-syscall" tabindex="-1">Last Error Syscall <a class="header-anchor" href="#last-error-syscall" aria-label="Permalink to &quot;Last Error Syscall&quot;">​</a></h3><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">syscall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AK_SYS_LAST_ERROR, buf, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buf));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// buf contains JSON with denial details</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="record-mode" tabindex="-1">Record Mode <a class="header-anchor" href="#record-mode" aria-label="Permalink to &quot;Record Mode&quot;">​</a></h3><p>Run with <code>AK_RECORD=1</code> to accumulate suggestions:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AK_RECORD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ./myapp</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="validation" tabindex="-1">Validation <a class="header-anchor" href="#validation" aria-label="Permalink to &quot;Validation&quot;">​</a></h2><p>P0 validates:</p><ul><li>Version field present and correct</li><li>All patterns are valid strings</li><li>All numbers are valid integers</li><li>No unknown fields (warning)</li></ul><h3 id="common-errors" tabindex="-1">Common Errors <a class="header-anchor" href="#common-errors" aria-label="Permalink to &quot;Common Errors&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Error</th><th>Cause</th><th>Fix</th></tr></thead><tbody><tr><td>&quot;Missing version&quot;</td><td>No version field</td><td>Add <code>&quot;version&quot;: &quot;1.0&quot;</code></td></tr><tr><td>&quot;Invalid JSON&quot;</td><td>Syntax error</td><td>Check JSON syntax</td></tr><tr><td>&quot;Pattern too long&quot;</td><td>Pattern &gt; 256 chars</td><td>Shorten pattern</td></tr><tr><td>&quot;Invalid CIDR&quot;</td><td>Bad CIDR format</td><td>Check format</td></tr></tbody></table>`,13))])}const f=d(c,[["render",k]]);export{C as __pageData,f as default};
