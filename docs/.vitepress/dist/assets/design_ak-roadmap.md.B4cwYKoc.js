import{_ as a,c as t,o as s,ag as e}from"./chunks/framework.bCALENAD.js";const u=JSON.parse('{"title":"Authority Kernel Roadmap","description":"","frontmatter":{},"headers":[],"relativePath":"design/ak-roadmap.md","filePath":"design/ak-roadmap.md","lastUpdated":1768808469000}'),n={name:"design/ak-roadmap.md"};function l(r,i,o,d,p,h){return s(),t("div",null,[...i[0]||(i[0]=[e(`<h1 id="authority-kernel-roadmap" tabindex="-1">Authority Kernel Roadmap <a class="header-anchor" href="#authority-kernel-roadmap" aria-label="Permalink to &quot;Authority Kernel Roadmap&quot;">​</a></h1><p><strong>Version:</strong> 1.0 <strong>Date:</strong> 2026-01-16</p><p>This document defines the P0/P1/P2 scope gates and completion criteria for the Authority Kernel migration.</p><hr><h2 id="scope-control-philosophy" tabindex="-1">Scope Control Philosophy <a class="header-anchor" href="#scope-control-philosophy" aria-label="Permalink to &quot;Scope Control Philosophy&quot;">​</a></h2><ul><li><strong>P0</strong>: Minimal viable deny-by-default. Ship it working.</li><li><strong>P1</strong>: Hardening and polish. Production-ready.</li><li><strong>P2</strong>: Advanced features. Future expansion.</li></ul><p>Each phase has explicit <strong>completion criteria</strong>. No phase is complete until ALL criteria pass.</p><hr><h2 id="p0-minimal-viable-deny-by-default" tabindex="-1">P0: Minimal Viable Deny-by-Default <a class="header-anchor" href="#p0-minimal-viable-deny-by-default" aria-label="Permalink to &quot;P0: Minimal Viable Deny-by-Default&quot;">​</a></h2><h3 id="goal" tabindex="-1">Goal <a class="header-anchor" href="#goal" aria-label="Permalink to &quot;Goal&quot;">​</a></h3><p>A working deny-by-default Authority Kernel with:</p><ul><li>Core effects enforced</li><li>POSIX compatibility layer</li><li>Agentic primitives functional</li><li>Actionable deny UX</li></ul><h3 id="p0-features" tabindex="-1">P0 Features <a class="header-anchor" href="#p0-features" aria-label="Permalink to &quot;P0 Features&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Feature</th><th>Description</th></tr></thead><tbody><tr><td>Policy Bootstrap</td><td>JSON policy from initrd or embedded</td></tr><tr><td>Deny-by-Default</td><td>Missing policy = fail closed</td></tr><tr><td>Effects Core</td><td><code>ak_authorize_and_execute()</code> working</td></tr><tr><td>Last Deny</td><td>Per-thread last denial with suggestion</td></tr><tr><td>FS Routing</td><td>open/openat routed through AK</td></tr><tr><td>NET Routing</td><td>connect routed through AK</td></tr><tr><td>DNS Effect</td><td><code>AK_E_NET_DNS_RESOLVE</code> with policy gate</td></tr><tr><td>TOOL_CALL Effect</td><td>Tool execution gated</td></tr><tr><td>WASM_INVOKE Effect</td><td>WASM execution gated</td></tr><tr><td>INFER Effect</td><td>Inference gated</td></tr><tr><td>SOFT Mode</td><td>Default routing mode working</td></tr><tr><td>Smoke Test</td><td><code>./tools/smoke.sh</code> passes</td></tr></tbody></table><h3 id="p0-completion-criteria" tabindex="-1">P0 Completion Criteria <a class="header-anchor" href="#p0-completion-criteria" aria-label="Permalink to &quot;P0 Completion Criteria&quot;">​</a></h3><ul><li>[ ] <strong>Policy Bootstrap</strong>: JSON policy loads from <code>/ak/policy.json</code> in initrd</li><li>[ ] <strong>Fail Closed</strong>: Missing policy = deny-all with clear console message</li><li>[ ] <strong>Effects Core</strong>: All P0 effects route through <code>ak_authorize_and_execute()</code></li><li>[ ] <strong>Last Deny</strong>: Denied operations populate last_deny with proper information</li><li>[ ] <strong>FS Routing</strong>: <code>open()</code> and <code>openat()</code> create <code>AK_E_FS_OPEN</code> effect</li><li>[ ] <strong>NET Routing</strong>: <code>connect()</code> creates <code>AK_E_NET_CONNECT</code> effect</li><li>[ ] <strong>DNS Gate</strong>: DNS resolution creates <code>AK_E_NET_DNS_RESOLVE</code> effect</li><li>[ ] <strong>Agentic Effects</strong>: All agentic effects enforced</li><li>[ ] <strong>Mode</strong>: SOFT mode is default and functional</li><li>[ ] <strong>Unit Tests</strong>: Pattern matching, JSON parsing, canonicalization all pass</li><li>[ ] <strong>Integration Tests</strong>: allow/deny scenarios pass</li><li>[ ] <strong>Smoke Test</strong>: <code>./tools/smoke.sh</code> exits 0</li></ul><h3 id="p0-non-goals-explicitly-deferred" tabindex="-1">P0 Non-Goals (Explicitly Deferred) <a class="header-anchor" href="#p0-non-goals-explicitly-deferred" aria-label="Permalink to &quot;P0 Non-Goals (Explicitly Deferred)&quot;">​</a></h3><ul><li>TOML policy compilation (P1)</li><li>unlink/rename/mkdir routing (P1)</li><li>bind/listen routing (P1)</li><li>PROC_SPAWN effect (P2)</li><li>HARD mode enforcement (P1)</li><li>Performance tuning (P1)</li></ul><hr><h2 id="p1-hardening-and-polish" tabindex="-1">P1: Hardening and Polish <a class="header-anchor" href="#p1-hardening-and-polish" aria-label="Permalink to &quot;P1: Hardening and Polish&quot;">​</a></h2><h3 id="goal-1" tabindex="-1">Goal <a class="header-anchor" href="#goal-1" aria-label="Permalink to &quot;Goal&quot;">​</a></h3><p>Production-ready Authority Kernel with:</p><ul><li>Complete POSIX routing</li><li>HARD mode</li><li>Performance optimizations</li></ul><h3 id="p1-features" tabindex="-1">P1 Features <a class="header-anchor" href="#p1-features" aria-label="Permalink to &quot;P1 Features&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Feature</th><th>Description</th></tr></thead><tbody><tr><td>FS Complete</td><td>unlink/rename/mkdir routed</td></tr><tr><td>NET Complete</td><td>bind/listen routed</td></tr><tr><td>HARD Mode</td><td>Raw syscalls denied</td></tr><tr><td>TOML Compile</td><td>Build-time ak.toml → JSON</td></tr><tr><td>Ring Buffer</td><td>Bounded audit ring for data-plane</td></tr><tr><td>Rate Limiting</td><td>Deny log rate limiting</td></tr></tbody></table><h3 id="p1-completion-criteria" tabindex="-1">P1 Completion Criteria <a class="header-anchor" href="#p1-completion-criteria" aria-label="Permalink to &quot;P1 Completion Criteria&quot;">​</a></h3><ul><li>[ ] <strong>FS Complete</strong>: unlink, rename, mkdir create appropriate effects</li><li>[ ] <strong>NET Complete</strong>: bind, listen create effects</li><li>[ ] <strong>HARD Mode</strong>: Setting mode=HARD denies raw effectful syscalls</li><li>[ ] <strong>TOML Compile</strong>: <code>make</code> automatically compiles ak.toml → embedded policy</li><li>[ ] <strong>Ring Buffer</strong>: Data-plane events use bounded ring</li><li>[ ] <strong>Rate Limiting</strong>: Deny messages rate-limited appropriately</li><li>[ ] <strong>Performance</strong>: Reasonable overhead for policy decisions</li></ul><hr><h2 id="p2-advanced-features" tabindex="-1">P2: Advanced Features <a class="header-anchor" href="#p2-advanced-features" aria-label="Permalink to &quot;P2: Advanced Features&quot;">​</a></h2><h3 id="goal-2" tabindex="-1">Goal <a class="header-anchor" href="#goal-2" aria-label="Permalink to &quot;Goal&quot;">​</a></h3><p>Full process model and advanced isolation.</p><h3 id="p2-features" tabindex="-1">P2 Features <a class="header-anchor" href="#p2-features" aria-label="Permalink to &quot;P2 Features&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Feature</th><th>Description</th></tr></thead><tbody><tr><td>PROC_SPAWN</td><td>Process creation effect</td></tr><tr><td>Exec/Fork</td><td>Exec and fork interception</td></tr><tr><td>Streaming</td><td>Streaming tool/infer responses</td></tr><tr><td>Enhanced Sandbox</td><td>Stronger WASM isolation</td></tr><tr><td>Attestation</td><td>Policy attestation for remote verification</td></tr></tbody></table><hr><h2 id="policy-format-p0-json" tabindex="-1">Policy Format (P0 JSON) <a class="header-anchor" href="#policy-format-p0-json" aria-label="Permalink to &quot;Policy Format (P0 JSON)&quot;">​</a></h2><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;read&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/app/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/lib/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/tmp/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;net&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;dns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api.github.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;connect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;dns:api.github.com:443&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;ip:10.0.0.0/8:5432&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;tools&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;allow&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http_get&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;file_read&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;deny&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;shell_exec&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;budgets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tool_calls&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tokens&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;wall_time_ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><hr><h2 id="compatibility-tiers" tabindex="-1">Compatibility Tiers <a class="header-anchor" href="#compatibility-tiers" aria-label="Permalink to &quot;Compatibility Tiers&quot;">​</a></h2><h3 id="tier-1-static-musl-recommended" tabindex="-1">Tier 1: Static/musl (Recommended) <a class="header-anchor" href="#tier-1-static-musl-recommended" aria-label="Permalink to &quot;Tier 1: Static/musl (Recommended)&quot;">​</a></h3><ul><li>Statically linked binaries</li><li>Simplest policy requirements</li><li>Profile: <code>tier1-musl</code></li></ul><h3 id="tier-2-dynamic-glibc" tabindex="-1">Tier 2: Dynamic/glibc <a class="header-anchor" href="#tier-2-dynamic-glibc" aria-label="Permalink to &quot;Tier 2: Dynamic/glibc&quot;">​</a></h3><ul><li>Dynamically linked binaries</li><li>Requires additional FS permissions for libraries</li><li>Profile: <code>tier2-glibc</code></li></ul><h3 id="tier-3-full-linux-compat" tabindex="-1">Tier 3: Full Linux Compat <a class="header-anchor" href="#tier-3-full-linux-compat" aria-label="Permalink to &quot;Tier 3: Full Linux Compat&quot;">​</a></h3><ul><li><strong>Out of scope</strong> for P0/P1</li><li>Future consideration</li></ul>`,44)])])}const k=a(n,[["render",l]]);export{u as __pageData,k as default};
